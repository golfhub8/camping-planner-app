ğŸ”§ Project-wide fixes: billing, recipes â†’ grocery, UX flow

Goals
	1.	Stripe checkout + webhooks reliably upgrade/downgrade the userâ€™s plan (Free â†” Pro), immediately unlocking printables and removing trip/grocery caps.
	2.	Saving external recipes pre-fills ingredients and full instructions (no â€œgrey code boxâ€), and the same checkbox UI used in Trips â†’ Meals appears in recipe modals.
	3.	â€œAdd to Tripâ€ works even when there are no trips yet (create trip inline, then add).
	4.	â€œAdd Selected to Groceryâ€ collects into a single, visible grocery list that can be reviewed, exported, or emailed.
	5.	Clean routing: Profile â†’ Account, nav order = Trips, Recipes, Grocery, Printables.
	6.	Add an â€œAI Trip Assistant (beta)â€ card at the top of Trips (stub onlyâ€”no model calls yet).

â¸»

1) Stripe + Plan state: fix checkout, webhook, session refresh

Backend
	â€¢	Create/verify these env vars are present:
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PRICE_YEARLY=price_... (the yearly Pro price)
STRIPE_WEBHOOK_SECRET=whsec_... (for the dev endpoint you showed)
APP_BASE_URL=https://<your-dev-host>.replit.dev (private dev URL)
	â€¢	Implement /api/billing/create-checkout-session:
	â€¢	Input: none (use logged-in user).
	â€¢	Create a subscription checkout session with mode: 'subscription', line_items: [{ price: STRIPE_PRICE_YEARLY, quantity: 1 }].
	â€¢	Include customer if the user has a saved stripeCustomerId; otherwise create a customer with the userâ€™s email and save stripeCustomerId on success.
	â€¢	Set success_url = ${APP_BASE_URL}/account?status=success and cancel_url = ${APP_BASE_URL}/account?status=cancel.
	â€¢	Return { url }.
	â€¢	Implement /api/stripe/webhook:
	â€¢	Verify signature with STRIPE_WEBHOOK_SECRET.
	â€¢	Handle:
	â€¢	checkout.session.completed: look up the user by customer or client_reference_id, save stripeSubscriptionId, set plan: 'pro', plan_expires_at: null.
	â€¢	customer.subscription.updated: if status becomes active â†’ ensure plan: 'pro'; if past_due or unpaid â†’ keep pro but consider banner; if canceled/incomplete_expired â†’ set plan: 'free'.
	â€¢	customer.subscription.deleted: set plan: 'free', null out subscription id.
	â€¢	Return 200.
	â€¢	Add /api/account/plan:
	â€¢	Returns { plan, tripLimit, groceryLimit, stripePortalUrl }.
	â€¢	Trip/Grocery limits: Free: {tripLimit: 5, groceryLimit: 5}, Pro: unlimited.
	â€¢	Add /api/billing/portal endpoint to create a Stripe customer portal session and return url.

Frontend
	â€¢	In the account page, on load, call /api/account/plan and show:
	â€¢	Badge: â€œFreeâ€ or â€œProâ€.
	â€¢	Benefits list:
	â€¢	Free: â€œUp to 5 tripsâ€, â€œUp to 5 grocery listsâ€, â€œFree printablesâ€.
	â€¢	Pro: â€œUnlimited tripsâ€, â€œUnlimited grocery listsâ€, â€œAll printables & gamesâ€, â€œFull packing checklistsâ€, â€œPriority updatesâ€.
	â€¢	â€œStart 7-Day Free Trialâ€ button â†’ POST /api/billing/create-checkout-session, then window.location.href = data.url. Handle errors with a toast (â€œNetwork errorâ€).
	â€¢	After returning from Stripe (/account?status=success), call /api/account/plan again and update UI (unlock printables immediately).
	â€¢	â€œManage Subscriptionâ€ â†’ POST /api/billing/portal, then redirect to returned url.

QA
	â€¢	From dev app, click â€œStart 7-Day Free Trialâ€, complete checkout with test card 4242 4242 4242 4242.
	â€¢	In Dashboard â†’ Webhooks, ensure events show â€œ200 OKâ€ (no â€œFailed to connectâ€).
	â€¢	Back on /account, badge shows Pro, printables download buttons are enabled.

â¸»

2) Fix Account routing + nav order
	â€¢	The profile avatar menu â†’ â€œMy Accountâ€ must link to /account (not /printables).
	â€¢	Reorder top nav: Trips, Recipes, Grocery, Printables.
	â€¢	Increase header height and remove the duplicate secondary header on Grocery.

â¸»

3) Save Recipe UX + robust parser

Problem: Ingredients/instructions sometimes blank or partial.

Solution
	â€¢	Create a server route /api/recipes/parse?url= that:
	â€¢	Fetches the page (server-side).
	â€¢	Tries to read JSON-LD @type: "Recipe" first (most reliable).
	â€¢	Fallback: scrape common selectors:
	â€¢	Ingredients: ul[class*="ingredient"] li, li[class*="ingredient"].
	â€¢	Instructions: ol[class*="instruction"] li, li[class*="step"], or paragraphs under .instructions.
	â€¢	Return { title, ingredients: string[] , instructions: string[] }.
	â€¢	Update the â€œSave Recipeâ€ modal:
	â€¢	On open, call /api/recipes/parse with the cardâ€™s sourceUrl.
	â€¢	Prefill plain text inputs (not code blocks) for Title, Ingredients (1 per line), Instructions (blank line between steps).
	â€¢	Show counts (â€œ12 ingredientsâ€, â€œ6 stepsâ€) and a small â€œRe-parseâ€ button.
	â€¢	Allow user edits; saving creates a â€œMy Recipeâ€ with stored arrays.

â¸»

4) Unify ingredient selection UI & make it feed Grocery
	â€¢	Extract the checkbox list you liked in Trips â†’ Meals into a reusable <IngredientSelector />. Props:
	â€¢	ingredients: string[], onAddToGrocery(selected: string[]), onMarkAlreadyHave(selected: string[]).
	â€¢	Use <IngredientSelector /> both inside the recipe modal and in trips â†’ meals.

Grocery â€œinboxâ€
	â€¢	Create a client store grocerySelections in localStorage, keyed by user id: